8. What to do with text inside double quotes

30. See Stasis will read as xp{player} skip their ph{untap_step}. need to quantify with all or not

52. tag additional? (see Ravaging Riftwurm)

66. Add english name conversion i.e. Lim-Dul's Vault

68. Inside double quotes we have ... this creature ... or ... this artifact ... etc should we self-ref these?

90. code programmatic download of cEDH primary deck as .tsv file

92. how to handle overload

101. Look at Spawnbroker.

111. Have to find creature types like Assembly-Worker with hyphens. These will be replaced by _ and we should either leave as is or change back
  o assembly-worker, power-plant
  o jump-start

115. the power and toughness mean different things
 - Calcite Snapper -> Whenever a land enters the battlefield under your control, you may switch Calcite Snapper's power and toughness until end of turn.
 - Broodstar -> Broodstar's power and toughness are each equal to the number of artifacts you control.

119. See Hanweir Battlements 
 'ob<permanent characteristics=creature quantifier=a>', 'named', 'ob<card ref=ffa73c0251393a8a18233b4446e4bac5>',
the two objects should be merged

120. how to figure out what 'xo<it>' refers to?

124. Pickling Error when dumping MTGCards _pickle.PicklingError: Can't pickle <class 'mtgcard.MTGCard'>: it's not the same object as mtgcard.MTGCard

tried
>>> from lituus.mtgl import mtgt
>>> import pickle
>>> t = mtgt.MTGTree()
>>> fout = open('test.pkl','wb')
>>> pickle.dump(t,fout)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
_pickle.PicklingError: Can't pickle <class 'mtgt.MTGTree'>: import of module 'mtgt' failed
which is different

126. Protection i.e Iridescent Angel "protection from all colors". We need a way to merge the 'all' into colors. that is a quantifier and a characteristic
 - same goes for mox opal etc ('xa<add>', 'xo<mana num=1>', 'of', 'xq<any>', 'ch<color>')

129. Add 'suspended' as a status. do the same for unattached See
>>> mv['Clockspinning']._card['mtgl']
[['kw<buyback>', '{3}'], ['xa<choose>', 'xo<ctr quantifier=a>', 'pr<on>', 'ob<permanent quantifier=target>', 'or', 'suspended', 'ob<card>', '.', 'remove', 'xo<ctr quantifier=that>', 'pr<from>', 'ob<permanent∨card quantifier=that>', 'or', 'xa<put>', 'xq<another>', 'of', 'xo<ctr quantifier=those>', 'pr<on>', 'xo<it>', '.']]

However after adding it to lituus status, got
>>> mv['Clockspinning']._card['mtgl']
[['kw<buyback>', '{3}'], ['xa<choose>', 'xo<ctr quantifier=a>', 'pr<on>', 'ob<permanent quantifier=target>', 'ob<card status=suspended>', '.', 'remove', 'xo<ctr quantifier=that>', 'pr<from>', 'ob<permanent∨card quantifier=that>', 'or', 'xa<put>', 'xq<another>', 'of', 'xo<ctr quantifier=those>', 'pr<on>', 'xo<it>', '.']]

The problem is that 'target' applies to both permanent and card but the two objects cannot be merged, should read ob<permanent quantifier=target> or ob<card status=suspended quantifier=target>

131. For stuff like 
  'xa<pay>', 'nu<3>', 'xc<life>'
should we combine the nu and the xc into xc<life num=3> or consider that any xa has a nu and a xc

133. pickle the n2r file

137. do we need to add_hanging for all prepositions i.e. 'from' or leave as is 

138. Thromok the Insatiable
  ['kw<devour>', 'nu<x>', ',', 'where', 'nu<x>', 'is', 'the', 'number', 'of', 'ob<permanent characteristics=creature>', 'devoured', 'xq<this>', 'way']
look for phrases ", where VAR is the number of" and figure out how to add this as a node i.e. Node = (number, n=nu<x>) where x = ...

139. Daybreak Coronet
['kw<enchant>', 'ob<permanent characteristics=creature>', 'pr<with>', 'ob<permanent characteristics=aura quantifier=another status=attached>', 'pr<to>', 'xo<it>']
This is the only card with a 'clause' after enchant obj and, this clause specifies details about the object to be enchanted

141. see Arcbound Wanderer, is there any other cases of a keyword<long hyphen>keyword?

143. mtgcard keywords and ability words are tokenized i.e lowercased and with underscore replacing spaces. How do we want to tree these in the MTGCard objects that is should we replace the underscores and capitalize the first letter in the called function or let the caller handle this

144. obj enters the battlefield tapped i.e. worn powerstone
 o this would be good to define an ETB node but how to place obj and status i.e. tapped
 0 would have to differniate from as enters.. and when ... enters

146. see Graf Rats (other meld cards)
 'sq<then>', 'ka<meld>', 'them', 'pr<into>', 'chittering', 'host']
Chittering Host should be tagged as a card

148. Mistmeadow Skulk 
[['kw<lifelink>', ',', 'kw<protection>', 'pr<from>', 'ch<cmc>', 'op<≥>', 'nu<3>']]
have to combine >= 3 into the ch<cmc>

150. have to redo activate and ability see Desert's Hold
 line 2 -> Enchanted creature can't attack or block, and its activated abilities can't be activated.
 ['and', 'xo<it>', 'ka<activate>', 'ob<ability>', 'cn<cannot>', 'be', 'ka<activate>']
 here 'ka<activate>', 'ob<ability>' should be ob<ability characteristics=activated'>

 and Abeyance
line 0 -> Until end of turn, target player can't cast instant or sorcery spells, and that player can't activate abilities that aren't mana abilities.
  ['and', 'xp<player quantifier=that>', 'cn<cannot>', 'ka<activate>', 'ob<ability>', 'xq<that>', 'arent', 'xo<mana_ability>']
here it should stay as ka<activate> ob<ability>

semi-fixed, have to go back into parser->rectify and fix xs<activated> where necessary need to look into triggered as well

151. fight
Ezuri's Predation
<root>
└ line:0
   └ability-line:0
    └spell-ability:0
     ├clause:0(tkns=['pr<for>', 'ob<permanent quantifier=each characteristics=creature>', 'xp<you>', 'xp<opponent>', 'xc<control>'])
     ├punctuation:0(symbol=,)
     ├clause:1(tkns=['ka<create>', 'ob<token quantifier=a meta=p/t≡4/4 characteristics=green∧beast∧creature>'])
     ├punctuation:1(symbol=.)
     ├clause:2(tkns=['xq<each>', 'of', 'ob<permanent quantifier=those characteristics=beast>'])
     ├clause:3(tkns=['ka<fight>', 'a', 'different', 'nu<1>', 'of', 'ob<permanent quantifier=those characteristics=creature>'])
     └punctuation:2(symbol=.)
in this case clause:2 and clause:3 both represent creatures

Arena (also in three other cards
Those creatures fight each other

158. Have we found all edge cases for shuffle and search

160. see Murderous Betrayal the clause rounded up is being treated as a seperate sub-cost due to the preceding comma

161. see Abbot of Keral Keep
clause ['the', 'pr<top>', 'ob<card>', 'of', 'zn<library player=you>'] 
is the object begin referenced but of course is not being picked up as such

how can we make the clause an object? and are their any other wordings for this clause or other types of claues

see 151 where Ezuri's Predation shows one such clause

manifest will result in many of these failures i.e. manifest the top card of your library

Ad Nauseum
clause:0(tkns=['pr<top>', 'ob<card>', 'of', 'zn<library player=you>', 'and'])

162. because we are only checking the first token of each line we miss trigger words in the middle of lines like Mana Drain and Pyromancer's Goggles

163. Have to look for stuff like object has "..." or object gains "..."

164. Have to rectify play i.e. play with the top card of your library revealed is not a keyword-action 
 - also revealed is distinct from reveal (have fixed this but what other keyword-actions are like this)

166. see Besmirch shows a case of 'and'ing two keyword actions with respect to the same object "untap and goad that creature"

168. with voting and everything removed, we could drop the check for 'pr<for> in  the graph_clause function (see Grudge Keeper) which didn't remove ka<vote> as planned
 - should vote that are untagged be retagged as an entity or thing etc
 - Brago's representative you get a additional vote (here vote should really be
   untagged)

169. should we look at retagging keyword-actions that 'fail' during graph clause or leave as is

173. move chain_zones into chain?

174. look at coordinating conjuctions

mtgl = cn<if>', 'xp<you>', 'xc<control>', 'ob<permanent characteristics=desert quantifier=a>', 'or', 'there', 'is', 'ob<card characteristics=desert quantifier=a>', 'pr<in>', 'zn<graveyard player=you>'

176. for search shuffle should we also designate who where possible
i.e. 
     ├clause:0(tkns=['sq<then>', 'xp<player quantifier=that>'])
     ├keyword-action-clause:2
     │├keyword-action:2(word=shuffle)
     │└zone:1(zone=zn<library player=their>)

could read as 
     ├clause:0(tkns=['sq<then>', ])
     ├keyword-action-clause:2
     │├player:0(player=xp<player quantifier=that>)
     │├keyword-action:2(word=shuffle)
     │└zone:1(zone=zn<library player=their>)

178. see Behomoth's Herald
1. for "Sacrifice a red creature, a green creature, and a white creature" need to figure out how to combine these under the sacrifice clause

2. the ',' between red creature and green creature is being dropped - it is present in the 'mtgl'
 -- think the commas are being dropped in the activated-ability graphing in the _subcosts_ portion with prev = i + 1 # skip the comma
however not skipping the comma also leads to issues

and in the parse tree, named still needs to be handled see 119

181. see Conjured Currency  "target permanent you neither own nor control" only card I can find with that phrasing. There are also both own and control (5 total) both of these cases need to be merged somehow

Conjured Currency ...
ob<permanent quantifier=target> 'xp<you>', 'neither', 'xc<own>', 'nor', 'xc<control>'

Remove Enchantments ...
'ob<permanent characteristics=enchantment quantifier=all>', 'xp<you>', 'both', 'xc<own>', 'and', 'xc<control>'

in both cases, the possessives are not being added to the respective objects

182. Exchange - Keep and eye on Juxtapose, Conjured Currency (see 181), Daring Thief,Gauntlets of Chaos, Puca's Mischeif,Spawnbroker -> hanging clause 
 o Gilded Drake "If you don't or can't make an exchange, sacrifice Gilded Drake." this exchange is being treated as a kwa,  (or can't make an exchange could all be dropped)

183. See Puca's mischief an opponent controls with an equal or lesser converted mana cost. missed a phrasing for combining operators (this would be less than or equal to)

187. Thinking that removing any tags from keyword actions that don't fit the patterns could be advantageous in finding cards that have keyword-actions i.e. Shadow of Doubt

188. for stuff like ob<...> ch<power|toughness> how can we put the characteristic into the object and where should it be done
 - same goes for players and life total

190 see Flameshot
... 'xa<choose>', 'among', 'nu<1>', ',', 'nu<2>', ',', 'or', 'ob<permanent characteristics=creature num=3 quantifier=target>' ...
divided as you choose among one, two, or three target creatures

only the num=3 is combined with the creature

191. for Hornet Nest we have a hanging clause

192. have to take care of "where x is ..." sooner than later and clauses inside double quotes as well
 - Qualify 1a: ['.', '"'] inside lituus-action add

197. See Urza's Mine in the add mana, we capture instead as a qualifying clause. have to make sure that once "if" condition, do "instead are coded, everything is fine

198. have to remember that for add mana, a triple conjuction does not necessarily mean it can produce three different types of mana, i.e. Twilight Mire

199. See False Dawn
that would ... instead ...
another if ... would ... instead version

201. see Chrome Mox. There are multiple other cards with similar and two with permanent vice card. Have to figure out how to chain these When Chrome Mox enters the battlefield, you may exile a nonartifact, nonland card from your hand.

... 'ka<exile>', 'a', 'ch<¬artifact>', ',', 'ch<¬land>', 'ob<card>', 'pr<from>' ...

But see Ashmouth Hound which is an example where a comma signifies not chaining
... 'by', 'a', 'ch<creature>', ',', 'ob<card ref=self>', 'xa<deal>', ...

In tkn, Ashmouth Hound has ch<> ',' ob<>
but Waste Not for example has ch<> ',' ch<> ob<>
and Godsire has ch<> ',' ch<> ',' ch<>

Another example is Angelic Voices

Look at Godsire where colors should be combined and then merged with the preceding obj

attempt to chain in the grapher when processing keyword-actions/(lituus actions?) that expect an object

203. Guided Passage
 'ka<reveal>', 'the', 'ob<card>', 'pr<in>', 'zn<library player=you>', '.'
└ line:0
   └ability-line:0
    └spell-ability:0
     ├keyword-action-clause:0
     │└keyword-action:0(word=reveal)
     ├clause:0(tkns=['ob<card>', 'pr<in>', 'zn<library player=you>'])
the clause specifies what is to be revealed

205. It's controller - xo<it> xp<controller> is a player as it refers to the controller of it do something lie xp<controller of=it> do the same for its owner

However, in doing so, parser->merge possessives "elif mtgl.is_player(tkn)" will need to be updated 

- there are 776 instances of xo<it> xp<owner> - 403 have a zone following
- there are 403 instances of xo<it> xp<controller> - 13 have a zone following

207. xa<enter> xa<die> should be retagged as something other than action (event??) or should they??

209. Look at Goblin Flotilla, has two triggered abilities

210. thought about adding 'turn' to lituus action (turn face up etc) but it will clash with phases

212. have to relook at add mana - make the subtree/clause standard

213. have to consider that an object could be something like "the top card of your library" and how to parse/graph it
 o the probelm in list_util->matchl is that it doesn't work with variable length lists so we cannot have ob<...> or (the top card of your library) 
 o one fix would be to make that phrase a rootless node of the form
  object
   type=card
   zone=library
   location=top

214. in collate objects have to extract num and push it up the tree but what other attributes do we need to look for? Lord of Shatterskull pass - some of the parameters an object can have ob<permanent characteristics=creature controller=player quantifier=each>

217. Look at what tags we can untag in the grapher. Examples numbers & trigger words

218. keyword action regenerate - sometimes is preceded by the 'object'. i.e. They cannot be regenerated In these cases, do we remove the kwa tag or what should we do

219. draw is a good example of implied and explicit players
 Opt - draw a card
 Fatal Lore has both cases of 'you' draw 3 cards and that player draws 3 cards
so, should we explicitly set an attribute or node (probably node) that defaults
to player='you' or only add it if it is present?

220. In mtgt, need to add the following capabiities to the MTGTree
 1. add a node without adding edge
 2. remove a node or attribute
 3. grab a subtree given the 'root'-id of that subtree
 4. from #3 print only a subtree

229. after downloading the json including MH1 cards, need to look at Hexdrinker for accurate graphing

230. tagger->fix_lvl_up is too hacky, need to go back and streamline it

231. find out why '$' is not working in regexs

232. Effects (609), events (700.1) etc what other rules terminilogy needs to be applied

234. see Splintering Wind {2}{G}: Splintering Wind deals 1 damage to target creature. Create a 1/1 green Splinter creature token. It has flying and "Cumulative upkeep Green." When it leaves the battlefield, it deals 1 damage to you and each creature you control. with strict parsing, the phrase "When it leaves the battlefield, it deals 1 damage to you and each creature you control." will not apply to the token because it is not inside the double quotes, rather it will apply to Splintering Wind. Note the phrasing on the original card:
 
 "If this token leaves play..."

 which explitly states that the token does damage on leaving the battlefield

235. need a more robust, portable and non-hacky means of identifying and 'capturing' double-quote enclosed phrases

236. See Curse of Opulence. The way that cards are parsed, we will get an effect of creating a gold token and the instructions will state: It has "Sacrifice this artifact: Add one mana of any color." this instruction is part of the gold token how can we identify these cases and then ensure they are grouped with the token. Same is also true for King Macar

237. should we move commas preceding double quotes outside of the double quote

238. Arlinn, Embraced by the Moon, Diabolical Salvation, Koth of the Hammer, Liliana of the Dark Realms, Mu Yanling, Sky Dancer, Nesting Dragon & Reef Worm have embedded singled-quoted clauses

239. need to run on check on quoted-clauses to confirm it works

240. add a replace for lists in list_util

241. when we start looking for triggered abilities mid-clause, have to remember single-quotes inside double quotes

242. Have to look at 'hierarchy', are we adding too many uncessary nodes?

243. See Elder Druid, need to find a way to combine keyword actions

244. With collation of objects (and other processing) we end up with 'hanging' phrases like
 o from target player's library
 o with cmc less than 3
 o attached to it
Have to handles these 

245. tree printing
<root>
├ line:0
│ │└kw-line:0
│   ├keyword-clause:0
│   │└keyword:0
│   └keyword-clause:1
│    ├keyword:1
│    └keyword-param:0
└ line:1
   └kw-line:1
    └keyword-clause:2
     └keyword:2

we do not want the vertical brace for kw-line:0 but do want it for keyword:0. Also in trees with greater branching/depths, only the first two immediate branch symbols are drawn (we may have to look into a recursive solution)

246. create a new module for set updates and move multiverse->_precompile_types there. consider moving the downloading of allcards.json there as well and only allow update of the card json from there 

249. see Greater Gargadon because of the order in which lines are partitioned and graphed, GG's activated ability cost "Sacrifice an artifact, creature, or land: ..." goes to graph_cost first where the commas are mistakenly used to break "an artifact", "creature" and "or land" into seperate subcosts
 - do we need to do a first pass and join stuff like decision points and conjoined node?

251. Monastery siege and others have choose x or y and then descriptions of each choice, have to 'modalize' these. There are 18 enchantments (not including sagas) that have this behavior

253. add a not capability to list_util->matchl

253. 'with', 'that', 'thats', 'to' ?prepositions? signifies a following phrase that should be attached to an object or node

255. see Goblin Vandal
'ob<permanent quantifier=target controller=defending∧player characteristics=artifact>'
Is the defending∧player the best way to take care of merge objects and possessives when the possessive has a status? or is there a better symbol than '∧' to use
Also are there other tokens where tag attributes are being dropped?

259. 1. Make a negated tag? for stuff like doesnt or add doesnt to conditionals or
 move cannot from conditionals. 
 2. do we need a verb tag for words like be, become that do not warrant a lituus action tag but could assist in graphing

262. do we need to collate KW_OBJECT?

264. tag 'time', but how? tag 'effect' as what?

265. Put (counters)
 o Doubling Season has ('twice that many of those counters') have to figure out how to get it to graph the 'put counter'
 o Clockspinning has "put another of those counters on it" since 'another of' is not being merged with counter, it is not getting graphing (contrast with Jhoira's Timebug "put another time counter on it" which is being graphed correctly)
 o Quarry Hauler "put another counter of that kind on it or remove one from it", the phrase "of that kind" messes up the grapher
  o see also Ageless Entity "put that many +1/+1 counters on Ageless Entity" 'that many' messes up the grapher, this is something we could possibly put into the counter with a variable i.e. nu<?>

266. Put (card)
 o again we have "the top card of" (Aberrant Researchers) or similar that cause put-card not to be graphed
 o and hanging clauses (Academy Researchers)

267. See Ajani, Mentor of Heroes 
['+nu<1>', ':', 'xa<distribute>', 'xo<ctr type=+1/+1 num=3>', 'among', 'nu<1>', ',', 'nu<2>', ',', 'or', 'ob<permanent characteristics=creature num=3 controller=you quantifier=target>', '.'] 
this is a case of needing to collate numbers but where and when should this be done? if done in the parser, it would introduce additional data structures to parser's output i.e. a tuple if done in the grapher, should we add a fist pass that creates unrooted subtrees of conjunctions? this approach could be used for other issues as well. or should we do it as the situatin arises?

268. Can we generalize collate to work on more than just Things? i.e. mana, costs etc
